<link rel="icon" type="image/png" href="favicon.png">
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <!-- Meta viewport cr√≠tico para m√≥viles -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alekiu FISH | Configurador Pro</title>
    <style>
        :root {
            /* Paleta */
            --bg-deep: #020b14;
            --bg-panel: #0b1628;
            --neon-cyan: #00FFFF;
            --neon-blue: #2979ff;
            --neon-green: #00ff9d;
            --neon-red: #ff0055;
            --whatsapp-green: #25D366;
            --text-main: #e0f7fa;
            
            /* Variables */
            --tank-l: 300px; --tank-h: 200px; --tank-w: 150px;
            --wood-h: 25px; --glass-lid-h: 4px;
            
            /* Materiales */
            --glass-border: rgba(0, 255, 255, 0.3);
            --glass-bg: rgba(200, 255, 255, 0.02);
            --water-color: rgba(0, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow-x: hidden;
            display: flex; flex-direction: column; min-height: 100vh;
        }

        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 50% 0%, #0f2540 0%, #020b14 80%);
        }

        /* --- HEADER --- */
        header { 
            padding: 4rem 1rem; /* M√°s espacio vertical para los peces */
            text-align: center; 
            border-bottom: 1px solid rgba(0,255,255,0.1); 
            position: relative; 
            overflow: hidden; 
        }
        
        .title-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            perspective: 500px;
            z-index: 10; /* El contenedor est√° por encima */
        }

        /* T√≠tulo Principal */
        h1 { 
            font-weight: 900; 
            font-size: 5rem; 
            line-height: 1;
            margin: 0; 
            font-style: italic;
            text-transform: uppercase;
            /* Degradado base */
            background-image: linear-gradient(to bottom, #ffffff 30%, var(--neon-cyan) 100%);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            
            /* Animaci√≥n Maestra de Aura (12 segundos) */
            animation: aura-cycle 12s linear infinite;
            
            position: relative; 
            z-index: 10; /* TEXTO POR DELANTE */
        }

        h2 {
            font-weight: 300; font-size: 2.5rem; letter-spacing: 10px; margin: 5px 0 0 0;
            color: #fff; text-transform: uppercase; text-shadow: 0 0 15px var(--neon-blue);
            z-index: 10;
        }

        /* ANIMACI√ìN DEL TEXTO (AURA) - SINCRONIZADA CON LOS PECES */
        /* Ciclo de 12s: 
           0s: Rojo (Pez 3)
           4s: Verde (Pez 1)
           8s: Azul (Pez 2)
        */
        @keyframes aura-cycle {
            /* --- FASE ROJA (Inicio 0% / Fin 100%) --- */
            0%, 5% { transform: scale(1.1); text-shadow: 0 0 80px var(--neon-red), 0 0 30px var(--neon-red); }
            15% { transform: scale(1); text-shadow: 0 0 30px rgba(0,255,255,0.1); } /* Reposo */
            
            /* --- FASE VERDE (33% = 4 seg) --- */
            33%, 38% { transform: scale(1.1); text-shadow: 0 0 80px var(--neon-green), 0 0 30px var(--neon-green); }
            48% { transform: scale(1); text-shadow: 0 0 30px rgba(0,255,255,0.1); } /* Reposo */

            /* --- FASE AZUL (66% = 8 seg) --- */
            66%, 71% { transform: scale(1.1); text-shadow: 0 0 80px var(--neon-cyan), 0 0 30px var(--neon-cyan); }
            81% { transform: scale(1); text-shadow: 0 0 30px rgba(0,255,255,0.1); } /* Reposo */

            /* Vuelta al inicio */
            95% { transform: scale(1); text-shadow: 0 0 30px rgba(0,255,255,0.1); }
            100% { transform: scale(1.1); text-shadow: 0 0 80px var(--neon-red), 0 0 30px var(--neon-red); }
        }

        /* --- PECES DEL T√çTULO --- */
        .title-fish {
            position: absolute; width: 24px; height: 12px;
            background: transparent; border: 2px solid;
            border-radius: 40% 50% 50% 40%; 
            z-index: 1; /* PECES POR DETR√ÅS */
            opacity: 0; /* Invisibles hasta que la animaci√≥n arranque */
        }
        .title-fish::after { 
            content: ''; position: absolute; right: -8px; top: -1px;
            width: 0; height: 0;
            border-top: 6px solid transparent; border-bottom: 6px solid transparent;
            border-left: 0; /* Limpiar */
            /* Cola invertida */
            border-right: 8px solid; 
            transform: scaleX(0.8);
        }

        /* --- PEZ 1: VERDE (Ataca al 33%) --- */
        .tf-1 { 
            border-color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green);
            animation: swim-green 12s linear infinite; 
        }
        .tf-1::after { border-right-color: var(--neon-green); }

        @keyframes swim-green {
            0% { top: 100px; left: -100px; opacity: 0; transform: rotate(0deg); }
            20% { opacity: 1; }
            33% { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(10deg) scale(1.2); } /* MUERDE */
            35% { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(10deg) scale(1); opacity: 1; }
            60% { top: -50px; left: 120%; opacity: 0; transform: rotate(0deg); }
            100% { opacity: 0; }
        }

        /* --- PEZ 2: AZUL (Ataca al 66%) --- */
        .tf-2 { 
            border-color: var(--neon-cyan); box-shadow: 0 0 15px var(--neon-cyan);
            animation: swim-cyan 12s linear infinite; 
        }
        .tf-2::after { border-right-color: var(--neon-cyan); }

        @keyframes swim-cyan {
            0% { opacity: 0; }
            40% { top: -50px; right: -100px; opacity: 0; transform: rotate(180deg); }
            50% { opacity: 1; }
            66% { top: 50%; right: 50%; transform: translate(50%, -50%) rotate(190deg) scale(1.2); } /* MUERDE */
            68% { top: 50%; right: 50%; transform: translate(50%, -50%) rotate(190deg) scale(1); opacity: 1; }
            90% { top: 150px; right: 120%; opacity: 0; transform: rotate(180deg); }
            100% { opacity: 0; }
        }

        /* --- PEZ 3: ROJO (Ataca al 0%/100%) --- */
        .tf-3 { 
            border-color: var(--neon-red); box-shadow: 0 0 15px var(--neon-red);
            animation: swim-red 12s linear infinite; 
        }
        .tf-3::after { border-right-color: var(--neon-red); }

        @keyframes swim-red {
            0% { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg) scale(1.2); opacity: 1; } /* MUERDE INICIO */
            20% { top: -100px; left: 50%; transform: translate(-50%, 0) rotate(-90deg); opacity: 0; }
            80% { top: 150px; left: 50%; transform: translate(-50%, 0) rotate(-90deg); opacity: 0; }
            90% { opacity: 1; }
            100% { top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg) scale(1.2); opacity: 1; } /* MUERDE FINAL */
        }


        @media (max-width: 768px) {
            h1 { font-size: 3.5rem; }
            h2 { font-size: 1.8rem; letter-spacing: 5px; }
        }

        /* --- LAYOUT --- */
        main {
            flex: 1; display: grid; grid-template-columns: 480px 1fr; gap: 3rem;
            padding: 3rem; max-width: 1800px; margin: 0 auto; width: 100%; align-items: start;
        }

        @media (max-width: 1000px) {
            main { display: flex; flex-direction: column; padding: 1rem; gap: 2rem; width: 100%; max-width: 100%; overflow-x: hidden; }
            .viewer-container { order: -1; height: 50vh !important; width: 100%; }
            .panel { width: 100%; padding: 1.5rem !important; }
        }

        /* PANEL */
        .panel {
            background: var(--bg-panel); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px; padding: 2.5rem; box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }

        h3 { color: var(--neon-cyan); margin: 1.5rem 0 0.8rem 0; font-size: 1.1rem; text-transform: uppercase; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 0.5rem; }
        
        .input-group { margin-bottom: 1rem; }
        label { display: block; font-size: 0.9rem; color: #94a3b8; margin-bottom: 5px; }
        
        input[type="number"], select {
            width: 100%; background: #020617; border: 1px solid #1e293b; color: #fff;
            padding: 12px; border-radius: 8px; font-family: monospace; font-size: 1.1rem;
            color: var(--neon-cyan); outline: none; transition: 0.3s;
        }
        input[type="number"]:focus { border-color: var(--neon-cyan); box-shadow: 0 0 15px rgba(0,255,255,0.2); }

        /* BOTONES RADIO (SELECCI√ìN) */
        .radio-options { display: flex; gap: 10px; margin-bottom: 1.5rem; }
        .radio-btn {
            flex: 1; padding: 15px; text-align: center; background: #0f2035; 
            border: 1px solid #2c3e50; cursor: pointer; font-size: 0.9rem; transition: 0.2s; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
        }
        /* Estilo para el seleccionado */
        .radio-btn.active { 
            background: var(--neon-cyan); color: #000; font-weight: bold; 
            box-shadow: 0 0 15px var(--neon-cyan); border-color: var(--neon-cyan);
        }

        .liters-display {
            font-size: 4rem; font-weight: bold; color: #fff; 
            text-shadow: 0 0 15px var(--neon-cyan); text-align: center; margin: 0.5rem 0; line-height: 1;
        }
        .liters-label { text-align: center; color: var(--neon-cyan); text-transform: uppercase; letter-spacing: 3px; margin-bottom: 2rem; }

        /* CARD FILTRO */
        .recommendation-card {
            display:flex; align-items:center; justify-content: space-between;
            background:rgba(0,255,255,0.03); padding: 1rem; 
            border-radius:12px; border:1px solid rgba(0,255,255,0.1);
            margin-bottom: 2rem;
        }
        .rec-left { display:flex; gap: 1rem; align-items: center; }
        .rec-icon { font-size: 2.5rem; }
        .rec-text h4 { margin: 0 0 5px 0; color: var(--neon-cyan); font-size: 1rem; }
        .rec-text p { margin: 0; font-size: 0.85rem; color: #aaa; }

        .filter-switch-container { display: flex; flex-direction: column; align-items: flex-end; }
        .neon-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .neon-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #1e293b; transition: .4s; border-radius: 34px; border: 1px solid #334155; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 4px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--neon-green); }
        input:checked + .slider:before { transform: translateX(18px); background-color: #000; }

        /* RESUMEN */
        .summary-box {
            margin-top: 2rem; background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--neon-green); border-radius: 12px; padding: 1.5rem;
        }
        .summary-header { color: var(--neon-green); text-transform: uppercase; font-size: 1rem; border-bottom: 1px dashed rgba(255,255,255,0.2); padding-bottom: 10px; margin-bottom: 10px; }
        .summary-item { display: flex; justify-content: space-between; font-size: 0.95rem; margin-bottom: 8px; color: #ccc; }
        .summary-total { display: flex; justify-content: space-between; margin-top: 15px; border-top: 1px solid var(--neon-green); padding-top: 10px; font-size: 1.5rem; color: var(--neon-green); font-weight: bold; }
        .remove-item { color: #ff4444; cursor: pointer; margin-left: 10px; }

        .btn-whatsapp {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            width: 100%; margin-top: 20px; padding: 15px;
            background: var(--whatsapp-green); color: #fff; border: none; border-radius: 8px;
            font-size: 1.1rem; font-weight: bold; text-transform: uppercase;
            cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }
        .btn-whatsapp:hover { background: #20bd5a; transform: translateY(-3px); }

        /* --- VISUALIZADOR 3D --- */
        .viewer-container {
            position: relative; height: 750px;
            background: radial-gradient(circle, #132235 0%, transparent 70%);
            border-radius: 16px; overflow: hidden; cursor: grab;
            display: flex; align-items: center; justify-content: center;
            perspective: 2000px;
            touch-action: none; 
        }
        .viewer-container:active { cursor: grabbing; }
        .instruction-overlay {
            position: absolute; bottom: 20px; width: 100%; text-align: center;
            color: rgba(255,255,255,0.4); font-size: 0.9rem; pointer-events: none; text-transform: uppercase; letter-spacing: 2px;
        }

        /* ESCENA 3D */
        .scene { position: relative; width: 0; height: 0; transform-style: preserve-3d; transform: rotateX(-20deg) rotateY(35deg); transition: transform 0.05s linear; }
        .tank { transform-style: preserve-3d; position: absolute; }
        .face { position: absolute; background: var(--glass-bg); border: 1px solid var(--glass-border); box-shadow: 0 0 40px rgba(0,255,255,0.05) inset; backface-visibility: visible; transition: all 0.4s ease; }

        /* Geometr√≠a */
        .f-front { width: var(--tank-l); height: var(--tank-h); transform: translate(-50%, -50%) translateZ(calc(var(--tank-w) / 2)); pointer-events: none; }
        .f-back  { width: var(--tank-l); height: var(--tank-h); transform: translate(-50%, -50%) rotateY(180deg) translateZ(calc(var(--tank-w) / 2)); }
        .f-right { width: var(--tank-w); height: var(--tank-h); transform: translate(-50%, -50%) rotateY(90deg) translateZ(calc(var(--tank-l) / 2)); }
        .f-left  { width: var(--tank-w); height: var(--tank-h); transform: translate(-50%, -50%) rotateY(-90deg) translateZ(calc(var(--tank-l) / 2)); }
        .f-top   { width: var(--tank-l); height: var(--tank-w); transform: translate(-50%, -50%) rotateX(90deg) translateZ(calc(var(--tank-h) / 2)); }
        .f-bottom{ width: var(--tank-l); height: var(--tank-w); transform: translate(-50%, -50%) rotateX(-90deg) translateZ(calc(var(--tank-h) / 2)); background: rgba(0,0,0,0.95); border:1px solid #333; }

        .water { position: absolute; top: 0; left: 0; transform-style: preserve-3d; }
        .w-face { position: absolute; background: var(--water-color); border: none; pointer-events: none; }
        .w-front { width: calc(var(--tank-l) - 2px); height: calc(var(--tank-h) * 0.85); transform: translate(-50%, -50%) translateZ(calc(var(--tank-w) / 2 - 1px)) translateY(calc(var(--tank-h) * 0.075)); }
        .w-back  { width: calc(var(--tank-l) - 2px); height: calc(var(--tank-h) * 0.85); transform: translate(-50%, -50%) rotateY(180deg) translateZ(calc(var(--tank-w) / 2 - 1px)) translateY(calc(var(--tank-h) * 0.075)); }
        .w-right { width: calc(var(--tank-w) - 2px); height: calc(var(--tank-h) * 0.85); transform: translate(-50%, -50%) rotateY(90deg) translateZ(calc(var(--tank-l) / 2 - 1px)) translateY(calc(var(--tank-h) * 0.075)); }
        .w-left  { width: calc(var(--tank-w) - 2px); height: calc(var(--tank-h) * 0.85); transform: translate(-50%, -50%) rotateY(-90deg) translateZ(calc(var(--tank-l) / 2 - 1px)) translateY(calc(var(--tank-h) * 0.075)); }
        .w-top   { width: calc(var(--tank-l) - 2px); height: calc(var(--tank-w) - 2px); transform: translate(-50%, -50%) rotateX(90deg) translateZ(calc((var(--tank-h) * 0.85) / 2 - (var(--tank-h) * 0.075))); background: rgba(0,255,255,0.25); box-shadow: 0 0 50px var(--neon-cyan); }

        .wood-texture { background-color: #4e342e; background-image: repeating-linear-gradient(45deg, rgba(255,255,255,0.03) 0px, rgba(255,255,255,0.03) 1px, transparent 1px, transparent 12px); border: 1px solid #3e2723; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); }
        .wood-group { display: none; transform-style: preserve-3d; } .wood-group.visible { display: block; }
        .wood-face { position: absolute; transition: all 0.4s ease; }

        .wl-front { width: var(--tank-l); height: var(--wood-h); transform: translate(-50%, -50%) translateZ(calc(var(--tank-w) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--wood-h) / 2) * -1 )); }
        .wl-back  { width: var(--tank-l); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(180deg) translateZ(calc(var(--tank-w) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--wood-h) / 2) * -1 )); }
        .wl-right { width: var(--tank-w); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--wood-h) / 2) * -1 )); }
        .wl-left  { width: var(--tank-w); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(-90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--wood-h) / 2) * -1 )); }
        .wl-top   { width: var(--tank-l); height: var(--tank-w); transform: translate(-50%, -50%) rotateX(90deg) translateZ(calc( var(--tank-h) / 2 + var(--wood-h) )); box-shadow: 0 0 20px rgba(0,0,0,0.5); }

        .wb-front { width: var(--tank-l); height: var(--wood-h); transform: translate(-50%, -50%) translateZ(calc(var(--tank-w) / 2)) translateY(calc( var(--tank-h) / 2 + var(--wood-h) / 2 )); }
        .wb-back  { width: var(--tank-l); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(180deg) translateZ(calc(var(--tank-w) / 2)) translateY(calc( var(--tank-h) / 2 + var(--wood-h) / 2 )); }
        .wb-right { width: var(--tank-w); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( var(--tank-h) / 2 + var(--wood-h) / 2 )); }
        .wb-left  { width: var(--tank-w); height: var(--wood-h); transform: translate(-50%, -50%) rotateY(-90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( var(--tank-h) / 2 + var(--wood-h) / 2 )); }
        .wb-bottom{ width: var(--tank-l); height: var(--tank-w); transform: translate(-50%, -50%) rotateX(-90deg) translateZ(calc( var(--tank-h) / 2 + var(--wood-h) )); box-shadow: 0 10px 30px rgba(0,0,0,0.8); }

        .glass-group { display: none; transform-style: preserve-3d; } .glass-group.visible { display: block; }
        .glass-face { position: absolute; background: rgba(220, 255, 255, 0.2); border: 1px solid rgba(255,255,255,0.4); box-shadow: inset 0 0 15px rgba(255,255,255,0.1); transition: all 0.4s ease; }
        .gl-front { width: var(--tank-l); height: var(--glass-lid-h); transform: translate(-50%, -50%) translateZ(calc(var(--tank-w) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--glass-lid-h) / 2) * -1 )); }
        .gl-back  { width: var(--tank-l); height: var(--glass-lid-h); transform: translate(-50%, -50%) rotateY(180deg) translateZ(calc(var(--tank-w) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--glass-lid-h) / 2) * -1 )); }
        .gl-right { width: var(--tank-w); height: var(--glass-lid-h); transform: translate(-50%, -50%) rotateY(90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--glass-lid-h) / 2) * -1 )); }
        .gl-left  { width: var(--tank-w); height: var(--glass-lid-h); transform: translate(-50%, -50%) rotateY(-90deg) translateZ(calc(var(--tank-l) / 2)) translateY(calc( (var(--tank-h) / 2 + var(--glass-lid-h) / 2) * -1 )); }
        .gl-top   { width: var(--tank-l); height: var(--tank-w); transform: translate(-50%, -50%) rotateX(90deg) translateZ(calc( var(--tank-h) / 2 + var(--glass-lid-h) )); background: rgba(220, 255, 255, 0.15); }

        .metal-mode .face { border: 8px solid #bdc3c7; }

        /* --- PECES --- */
        .aquarium-content { position: absolute; top: 0; left: 0; width: 0; height: 0; transform-style: preserve-3d; pointer-events: none; }
        .fish-wrapper { position: absolute; transform-style: preserve-3d; animation: swim-path 20s linear infinite, float-y 4s ease-in-out infinite; }
        .fish-model { position: relative; transform-style: preserve-3d; }
        .fish-part { position: absolute; backface-visibility: visible; }

        /* BETTA */
        .betta .body { width: 30px; height: 12px; background: var(--fish-color); border-radius: 10px; box-shadow: 0 0 8px var(--fish-color); }
        .betta .tail { width: 45px; height: 35px; background: linear-gradient(90deg, var(--fish-color), transparent); top: -10px; left: -38px; border-radius: 50% 0 0 50%; opacity: 0.9; transform-origin: right center; animation: tail-wag 0.8s ease-in-out infinite alternate; }
        .betta .fin { width: 15px; height: 10px; background: var(--fish-color); top: 8px; left: 5px; transform: rotateX(45deg); opacity: 0.7; }

        /* GOLDFISH */
        .gold .body { width: 34px; height: 24px; background: var(--fish-body-grad); border-radius: 50% 50% 40% 40%; box-shadow: inset -2px -2px 6px rgba(0,0,0,0.2); }
        .gold .tail { width: 28px; height: 32px; background: radial-gradient(circle at right, var(--fish-tail-color), transparent); position: absolute; top: -4px; left: -20px; border-radius: 50% 0 0 50%; opacity: 0.9; transform-origin: right center; animation: tail-wag 0.5s ease-in-out infinite alternate; }
        .gold .dorsal { width: 16px; height: 10px; background: var(--fish-tail-color); position: absolute; top: -8px; left: 10px; border-radius: 50% 50% 0 0; opacity: 0.8; transform: translateZ(0); }
        .gold .pectoral { width: 10px; height: 6px; background: var(--fish-tail-color); position: absolute; top: 14px; left: 18px; opacity: 0.8; animation: fin-flutter 0.2s linear infinite alternate; }
        .gold .pectoral.left { transform: translateZ(2px) rotateY(45deg); }
        .gold .pectoral.right { transform: translateZ(-2px) rotateY(-45deg); }

        @keyframes swim-path {
            0%   { transform: translateX(calc(var(--tank-l) * -0.30)) translateY(calc(var(--tank-h) * var(--ratio-y))) translateZ(calc(var(--tank-w) * var(--ratio-z))) rotateY(0deg); }
            49%  { transform: translateX(calc(var(--tank-l) * 0.30))  translateY(calc(var(--tank-h) * var(--ratio-y))) translateZ(calc(var(--tank-w) * var(--ratio-z))) rotateY(0deg); }
            50%  { transform: translateX(calc(var(--tank-l) * 0.30))  translateY(calc(var(--tank-h) * var(--ratio-y))) translateZ(calc(var(--tank-w) * var(--ratio-z))) rotateY(180deg); }
            99%  { transform: translateX(calc(var(--tank-l) * -0.30)) translateY(calc(var(--tank-h) * var(--ratio-y))) translateZ(calc(var(--tank-w) * var(--ratio-z))) rotateY(180deg); }
            100% { transform: translateX(calc(var(--tank-l) * -0.30)) translateY(calc(var(--tank-h) * var(--ratio-y))) translateZ(calc(var(--tank-w) * var(--ratio-z))) rotateY(0deg); }
        }
        @keyframes float-y { 0%, 100% { margin-top: -5px; } 50% { margin-top: 5px; } }
        @keyframes tail-wag { from { transform: rotateY(20deg); } to { transform: rotateY(-20deg); } }
        @keyframes fin-flutter { from { transform: translateZ(2px) rotateY(30deg); } to { transform: translateZ(2px) rotateY(60deg); } }

        /* FOOTER */
        .shop-section { padding: 2rem; background: #050f1e; border-top: 1px solid rgba(255,255,255,0.05); margin-top: auto; }
        .shop-title { margin-bottom: 1.5rem; padding-left: 2rem; color: var(--neon-cyan); font-size: 1.2rem; border-left: 4px solid var(--neon-cyan); text-transform: uppercase; }
        .carousel-container { display: flex; overflow-x: auto; gap: 2rem; padding: 1rem 2rem; scroll-snap-type: x mandatory; scrollbar-width: thin; scrollbar-color: var(--neon-cyan) #020b14; }
        .product-card { flex: 0 0 260px; scroll-snap-align: start; background: #0f172a; border: 1px solid rgba(255,255,255,0.05); border-radius: 12px; padding: 1.5rem; transition: transform 0.3s, border-color 0.3s; display: flex; flex-direction: column; }
        .product-card:hover { transform: translateY(-5px); border-color: var(--neon-cyan); box-shadow: 0 5px 15px rgba(0,255,255,0.1); }
        .p-img { height: 160px; background: #1e293b; border-radius: 8px; margin-bottom: 1rem; display: flex; align-items: center; justify-content: center; font-size: 4rem; overflow: hidden; }
        .p-name { font-size: 1rem; margin-bottom: 0.5rem; color: #fff; font-weight: 600; }
        .p-price { color: var(--neon-green); font-weight: bold; font-size: 1.2rem; margin-bottom: 1rem; }
        .p-btn { margin-top: auto; width: 100%; padding: 10px; background: transparent; border: 2px solid var(--neon-cyan); color: var(--neon-cyan); cursor: pointer; text-transform: uppercase; font-weight: bold; letter-spacing: 1px; transition: all 0.3s; font-size: 0.8rem; }
        .p-btn:hover { background: var(--neon-cyan); color: #020b14; box-shadow: 0 0 15px var(--neon-cyan); }
    </style>
</head>
<body>

    <div class="bg-animation"></div>

    <header>
        <div class="title-container">
            <h1>Alekiu</h1>
            <h2>FISH</h2>
            <div class="title-fish tf-1"></div>
            <div class="title-fish tf-2"></div>
            <div class="title-fish tf-3"></div>
        </div>
    </header>

    <main>
        <section class="panel controls">
            <div class="liters-display" id="txtLiters">0</div>
            <div class="liters-label">Litros Totales</div>

            <div class="recommendation-card">
                <div class="rec-left">
                    <div class="rec-img-placeholder" id="recIcon">‚öôÔ∏è</div>
                    <div class="rec-text">
                        <h4 id="recTitle">Analizando...</h4>
                        <p id="recDesc">Calculando filtraci√≥n...</p>
                    </div>
                </div>
                <div class="filter-switch-container">
                    <span style="font-size:0.7rem; color:var(--neon-green); margin-bottom:3px;">INCLUIR</span>
                    <label class="neon-switch">
                        <input type="checkbox" id="checkFilter" checked onchange="updateTank()">
                        <span class="slider"></span>
                    </label>
                    <span style="font-size:0.7rem; color:#aaa;">+S/ <span id="filterPriceDisplay">0</span></span>
                </div>
            </div>

            <br>
            <h3>Dimensiones (cm)</h3>
            <div class="input-group">
                <label>Largo (Frontal)</label>
                <input type="number" id="inpL" value="120" min="30" max="300">
            </div>
            <div class="input-group">
                <label>Alto (Altura)</label>
                <input type="number" id="inpH" value="50" min="20" max="150">
            </div>
            <div class="input-group">
                <label>Fondo (Profundidad)</label>
                <input type="number" id="inpW" value="40" min="20" max="100">
            </div>

            <h3>Acabados</h3>
            <label>Borde / Estructura</label>
            <div class="radio-options" id="finish-options">
                <div class="radio-btn active" onclick="setFinish('rimless', this)">Sin Marco (S/ 0)</div>
                <div class="radio-btn" onclick="setFinish('metal', this)">Aluminio (+S/ 50)</div>
            </div>

            <label>Tapa Superior</label>
            <select id="selLid" onchange="updateTank()">
                <option value="none">Sin Tapa (S/ 0)</option>
                <option value="glass">Tapa de Vidrio 3D (+S/ 10)</option>
                <option value="wood">Tapa de Madera 3D (+S/ 100)</option>
            </select>

            <br><br>
            <h3>Extras</h3>
            <label>Base Estructura</label>
            <div class="radio-options" id="base-options">
                <div class="radio-btn active" onclick="setBase(false, this)">No Incluir</div>
                <div class="radio-btn" onclick="setBase(true, this)">Base Madera (+S/ 150)</div>
            </div>

            <div class="summary-box">
                <div class="summary-header">Detalle de Cotizaci√≥n</div>
                <div id="orderList"></div>
                <div class="summary-total">
                    <span>TOTAL:</span>
                    <span id="totalPrice">S/ 0.00</span>
                </div>
                <button class="btn-whatsapp" onclick="sendToWhatsapp()">
                    <span>üí¨ Solicitar por WhatsApp</span>
                </button>
            </div>
        </section>

        <section class="viewer-container" id="viewer">
            <div class="instruction-overlay">üñ±Ô∏è Arrastra para girar 360¬∞</div>
            <div class="scene" id="scene">
                <div class="tank" id="tank">
                    <div class="face f-front"></div>
                    <div class="face f-back"></div>
                    <div class="face f-right"></div>
                    <div class="face f-left"></div>
                    <div class="face f-bottom"></div>
                    <div class="wood-group" id="woodLidGroup"><div class="wood-face wood-texture wl-front"></div><div class="wood-face wood-texture wl-back"></div><div class="wood-face wood-texture wl-right"></div><div class="wood-face wood-texture wl-left"></div><div class="wood-face wood-texture wl-top"></div></div>
                    <div class="glass-group" id="glassLidGroup"><div class="glass-face gl-front"></div><div class="glass-face gl-back"></div><div class="glass-face gl-right"></div><div class="glass-face gl-left"></div><div class="glass-face gl-top"></div></div>
                    <div class="wood-group" id="woodBaseGroup"><div class="wood-face wood-texture wb-front"></div><div class="wood-face wood-texture wb-back"></div><div class="wood-face wood-texture wb-right"></div><div class="wood-face wood-texture wb-left"></div><div class="wood-face wood-texture wb-bottom"></div></div>
                    <div class="aquarium-content" id="lifeContainer"></div>
                    <div class="water"><div class="w-face w-front"></div><div class="w-face w-back"></div><div class="w-face w-right"></div><div class="w-face w-left"></div><div class="w-face w-top"></div></div>
                </div>
            </div>
        </section>
    </main>

    <section class="shop-section">
        <div class="shop-title">Accesorios (Se suman al total)</div>
        <div class="carousel-container" id="shopCarousel"></div>
    </section>

    <script>
        let currentScale = 6;
        let currentFinish = 'rimless';
        let currentBase = false; 
        let cart = [];
        let currentTotal = 0;

        const root = document.documentElement;
        const inpL = document.getElementById('inpL'), inpH = document.getElementById('inpH'), inpW = document.getElementById('inpW');
        const txtLiters = document.getElementById('txtLiters');
        const tankEl = document.getElementById('tank'), selLid = document.getElementById('selLid');
        const woodLidGroup = document.getElementById('woodLidGroup'), glassLidGroup = document.getElementById('glassLidGroup'), woodBaseGroup = document.getElementById('woodBaseGroup');
        const lifeContainer = document.getElementById('lifeContainer');
        const orderList = document.getElementById('orderList'), totalPriceEl = document.getElementById('totalPrice');
        const checkFilter = document.getElementById('checkFilter'), filterPriceDisplay = document.getElementById('filterPriceDisplay');
        const recIcon = document.getElementById('recIcon'), recTitle = document.getElementById('recTitle'), recDesc = document.getElementById('recDesc');

        function determineScale() {
            currentScale = window.innerWidth < 768 ? 2.8 : 6;
            updateTank();
        }
        window.addEventListener('resize', determineScale);

        function updateTank() {
            let l = parseFloat(inpL.value) || 30;
            let h = parseFloat(inpH.value) || 30;
            let w = parseFloat(inpW.value) || 30;
            let volume = (l * h * w) / 1000;
            txtLiters.innerText = Math.round(volume);

            root.style.setProperty('--tank-l', (l * currentScale) + 'px');
            root.style.setProperty('--tank-h', (h * currentScale) + 'px');
            root.style.setProperty('--tank-w', (w * currentScale) + 'px');

            let filterData = getFilterData(volume);
            recIcon.innerText = filterData.icon;
            recTitle.innerText = filterData.name;
            recDesc.innerText = filterData.desc;
            filterPriceDisplay.innerText = filterData.price;

            woodLidGroup.classList.remove('visible');
            glassLidGroup.classList.remove('visible');
            woodBaseGroup.classList.remove('visible');

            if(selLid.value === 'wood') woodLidGroup.classList.add('visible');
            if(selLid.value === 'glass') glassLidGroup.classList.add('visible');
            if(currentBase) woodBaseGroup.classList.add('visible');

            tankEl.classList.toggle('metal-mode', currentFinish === 'metal');

            calculateQuote(volume, filterData);
            generateLife(volume);
        }

        function getFilterData(vol) {
            if (vol < 40) return { name: "Filtro Cascada Mini", price: 45, icon: "üíß", desc: "Para nano acuarios" };
            if (vol < 100) return { name: "Filtro Interno/Cascada", price: 85, icon: "üîã", desc: "Filtraci√≥n media" };
            if (vol < 250) return { name: "Canister Externo", price: 380, icon: "üõ¢Ô∏è", desc: "Agua cristalina" };
            return { name: "Sump Profesional", price: 650, icon: "üè≠", desc: "Filtraci√≥n industrial" };
        }

        function calculateQuote(liters, filterData) {
            let basePrice = 0;
            if (liters <= 30) basePrice = 50;
            else if (liters <= 50) basePrice = 70;
            else if (liters <= 80) basePrice = 100;
            else if (liters <= 100) basePrice = 200;
            else if (liters <= 120) basePrice = 220;
            else if (liters <= 150) basePrice = 250;
            else if (liters <= 200) basePrice = 300;
            else basePrice = 300 + ((liters - 200) * 2);

            let finishPrice = (currentFinish === 'metal') ? 50 : 0;
            let finishName = (currentFinish === 'metal') ? 'Marco Aluminio' : 'Sin Marco';
            
            let lidPrice = 0;
            let lidName = 'Sin Tapa';
            if (selLid.value === 'wood') { lidPrice = 100; lidName = 'Tapa Madera 3D'; }
            if (selLid.value === 'glass') { lidPrice = 10; lidName = 'Tapa Vidrio 3D'; }

            let baseCost = currentBase ? 150 : 0;

            let html = `
                <div class="summary-item"><span>Pecera Base (${Math.round(liters)}L)</span><span>S/ ${basePrice.toFixed(2)}</span></div>
                <div class="summary-item"><span>${finishName}</span><span>S/ ${finishPrice.toFixed(2)}</span></div>
                <div class="summary-item"><span>${lidName}</span><span>S/ ${lidPrice.toFixed(2)}</span></div>
            `;

            if(currentBase) html += `<div class="summary-item"><span>Base Madera 3D</span><span>S/ ${baseCost.toFixed(2)}</span></div>`;

            let filterCost = checkFilter.checked ? filterData.price : 0;
            if (checkFilter.checked) html += `<div class="summary-item" style="color:var(--neon-green);"><span>‚úÖ ${filterData.name}</span><span>S/ ${filterCost.toFixed(2)}</span></div>`;

            let accTotal = 0;
            cart.forEach((item, idx) => {
                accTotal += item.price;
                html += `<div class="summary-item"><span>${item.name} <small class="remove-item" onclick="removeFromCart(${idx})">[X]</small></span><span>S/ ${item.price.toFixed(2)}</span></div>`;
            });

            orderList.innerHTML = html;
            currentTotal = basePrice + finishPrice + lidPrice + baseCost + filterCost + accTotal;
            totalPriceEl.innerText = "S/ " + currentTotal.toFixed(2);
        }

        function sendToWhatsapp() {
            let l = parseFloat(inpL.value);
            let h = parseFloat(inpH.value);
            let w = parseFloat(inpW.value);
            let liters = Math.round((l * h * w) / 1000);
            
            let basePrice = 0;
            if (liters <= 30) basePrice = 50;
            else if (liters <= 50) basePrice = 70;
            else if (liters <= 80) basePrice = 100;
            else if (liters <= 100) basePrice = 200;
            else if (liters <= 120) basePrice = 220;
            else if (liters <= 150) basePrice = 250;
            else if (liters <= 200) basePrice = 300;
            else basePrice = 300 + ((liters - 200) * 2);

            let finishPrice = (currentFinish === 'metal') ? 50 : 0;
            let finishName = (currentFinish === 'metal') ? 'Marco Aluminio' : 'Sin Marco (Acabado Lujo)';
            
            let lidPrice = 0;
            let lidName = 'Sin Tapa';
            if (selLid.value === 'wood') { lidPrice = 100; lidName = 'Tapa de Madera 3D'; }
            if (selLid.value === 'glass') { lidPrice = 10; lidName = 'Tapa de Vidrio 3D'; }

            let baseCost = currentBase ? 150 : 0;
            let filterCost = checkFilter.checked ? parseInt(filterPriceDisplay.innerText) : 0;

            let msg = `*Hola Alekiu FISH! Quiero hacer realidad este acuario:*\n\n`;
            msg += `*DETALLES DE LA COTIZACION:*\n\n`;
            msg += `*Medidas:* ${l}x${h}x${w} cm\n`;
            msg += `*Volumen:* ${liters} Litros (S/ ${basePrice.toFixed(2)})\n\n`;
            msg += `*Estilo:* ${finishName} (+S/ ${finishPrice.toFixed(2)})\n`;
            msg += `*Tapa:* ${lidName} (+S/ ${lidPrice.toFixed(2)})\n`;
            
            if(currentBase) {
                msg += `*Base:* Estructura Madera 3D (+S/ 150.00)\n`;
            }

            if(checkFilter.checked) {
                msg += `*Sistema:* ${recTitle.innerText} (+S/ ${filterCost.toFixed(2)})\n`;
            }

            if(cart.length > 0) {
                msg += `\n*ACCESORIOS EXTRA:*\n`;
                cart.forEach(item => {
                    msg += `- ${item.name} (S/ ${item.price.toFixed(2)})\n`;
                });
            }

            msg += `\n*INVERSION TOTAL:* S/ ${currentTotal.toFixed(2)}\n\n`;
            msg += `*Por favor, confirmenme disponibilidad.*`;

            let encodedMsg = encodeURIComponent(msg);
            window.open(`https://wa.me/51908761978?text=${encodedMsg}`, '_blank');
        }

        function generateLife(liters) {
            let targetCount;
            if(liters < 60) targetCount = Math.floor(Math.random() * 3) + 1; 
            else if(liters <= 150) targetCount = Math.floor(Math.random() * 3) + 3; 
            else targetCount = Math.floor(Math.random() * 3) + 5; 

            if (lifeContainer.childElementCount === targetCount) return;

            lifeContainer.innerHTML = '';
            const colorsBetta = ['#00FFFF', '#FF0000', '#FFFFFF'];
            const colorsGoldfish = [
                { b: 'linear-gradient(to right, #FFD700, #ffffff)', t: '#FFD700' }, 
                { b: 'linear-gradient(to right, #FFA500, #ffffff)', t: '#FFA500' }, 
                { b: 'linear-gradient(to right, #FF4500, #eeeeee)', t: '#FF4500' }  
            ];

            for(let i=0; i<targetCount; i++) {
                const type = Math.random() > 0.6 ? 'betta' : 'gold';
                const wrapper = document.createElement('div');
                wrapper.className = 'fish-wrapper';

                const ratioY = (Math.random() * 0.6) - 0.25; 
                const ratioZ = (Math.random() * 0.8 - 0.4); 

                wrapper.style.setProperty('--ratio-y', ratioY);
                wrapper.style.setProperty('--ratio-z', ratioZ);
                wrapper.style.animationDuration = (15 + Math.random()*10) + 's';
                wrapper.style.animationDelay = (Math.random()*-20) + 's';
                let scale = 0.7 + Math.random() * 0.5;
                wrapper.style.transform = `scale(${scale})`;

                const model = document.createElement('div');
                model.className = `fish-model ${type}`;

                if(type === 'betta') {
                    let c = colorsBetta[Math.floor(Math.random() * colorsBetta.length)];
                    model.style.setProperty('--fish-color', c);
                    model.innerHTML = `<div class="fish-part body"></div><div class="fish-part tail"></div><div class="fish-part fin"></div>`;
                } else {
                    let p = colorsGoldfish[Math.floor(Math.random() * colorsGoldfish.length)];
                    model.style.setProperty('--fish-body-grad', p.b);
                    model.style.setProperty('--fish-tail-color', p.t);
                    model.innerHTML = `<div class="fish-part body"></div><div class="fish-part tail"></div><div class="fish-part dorsal"></div><div class="fish-part pectoral left"></div><div class="fish-part pectoral right"></div>`;
                }
                wrapper.appendChild(model);
                lifeContainer.appendChild(wrapper);
            }
        }

        function setFinish(t, btn) {
            document.getElementById('finish-options').querySelectorAll('.radio-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentFinish = t; updateTank();
        }

        function setBase(hasBase, btn) {
            document.getElementById('base-options').querySelectorAll('.radio-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentBase = hasBase; 
            updateTank();
        }

        function addToCart(n, p) { cart.push({name:n, price:p}); updateTank(); }
        function removeFromCart(i) { cart.splice(i, 1); updateTank(); }

        [inpL, inpH, inpW].forEach(el => el.addEventListener('input', updateTank));

        const viewer = document.getElementById('viewer'), scene = document.getElementById('scene');
        let isDragging = false, startX, startY, rotX = -15, rotY = 35;
        const startDrag = (x, y) => { isDragging = true; startX = x; startY = y; viewer.style.cursor = 'grabbing'; };
        const stopDrag = () => { isDragging = false; viewer.style.cursor = 'grab'; };
        const moveDrag = (x, y) => {
            if(!isDragging) return;
            let dX = x - startX, dY = y - startY;
            rotY += dX * 0.3; rotX -= dY * 0.3;
            rotX = Math.max(-90, Math.min(90, rotX));
            scene.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
            startX = x; startY = y;
        };

        viewer.addEventListener('mousedown', e => startDrag(e.clientX, e.clientY));
        window.addEventListener('mouseup', stopDrag);
        window.addEventListener('mousemove', e => moveDrag(e.clientX, e.clientY));
        
        viewer.addEventListener('touchstart', e => startDrag(e.touches[0].clientX, e.touches[0].clientY), {passive: false});
        window.addEventListener('touchend', stopDrag);
        viewer.addEventListener('touchmove', e => {
            if(isDragging) e.preventDefault(); 
            moveDrag(e.touches[0].clientX, e.touches[0].clientY);
        }, {passive: false});

        const products = [
            { n: "Filtro Canister Pro", p: 350, i: "üõ¢Ô∏è" }, { n: "Luz LED Full Spectrum", p: 180, i: "üí°" },
            { n: "Roca Drag√≥n (Kg)", p: 15, i: "ü™®" }, { n: "Ra√≠z Roja (Driftwood)", p: 45, i: "ü™µ" },
            { n: "Sustrato Japon√©s", p: 120, i: "üå±" }, { n: "Sistema CO2 2L", p: 450, i: "ü´ß" },
            { n: "Calentador Titanio", p: 80, i: "üå°Ô∏è" }, { n: "Alimento Granulado", p: 35, i: "üêü" },
            { n: "Limpiador Magn√©tico", p: 40, i: "üß≤" }
        ];
        const carousel = document.getElementById('shopCarousel');
        products.forEach(prod => {
            carousel.innerHTML += `
                <div class="product-card">
                    <div class="p-img">${prod.i}</div><div class="p-name">${prod.n}</div><div class="p-price">S/ ${prod.p.toFixed(2)}</div>
                    <button class="p-btn" onclick="addToCart('${prod.n}', ${prod.p})">A√±adir +</button>
                </div>`;
        });

        determineScale();
        updateTank();
    </script>
</body>
</html>
